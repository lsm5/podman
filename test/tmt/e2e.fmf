require:
    - autoconf
    - automake
    - golang
    - gpgme-devel
    - libseccomp-devel
    - slirp4netns

environment:
    ROOTLESS_USER: "fedora"
adjust+:
    - when: distro == centos-stream
      environment+:
        ROOTLESS_USER: "ec2-user"
    - when: distro == rhel
      environment+:
        ROOTLESS_USER: "cloud-user"

/local-root:
    tag: [ local, root, e2e ]
    summary: local rootful test
    test: cd $TMT_TREE && make && make localintegration
    duration: 30m
    
/local-rootless:
    tag: [ local, rootless, e2e ]
    summary: rootless test
    test: loginctl enable-linger $ROOTLESS_USER && chown -R $ROOTLESS_USER $TMT_TREE && su - "$ROOTLESS_USER" -c "cd $TMT_TREE && make && make localintegration"
    duration: 30m

/remote-root:
    tag: [ remote, root, e2e ]
    summary: remote rootful test
    test: cd $TMT_TREE && make && make remoteintegration
    duration: 30m

/remote-rootless:
    tag: [ remote, rootless, e2e ]
    summary: remote rootless test
    test: loginctl enable-linger $ROOTLESS_USER && chown -R $ROOTLESS_USER $TMT_TREE && su - "$ROOTLESS_USER" -c "cd $TMT_TREE && make && make remoteintegration"
    duration: 30m
